{"version":"1.0","id":"ba46c648-347c-4a98-9b0d-4384d85068ef","name":"NSQL Spark Map Blob","permissions":"Owner","cells":[{"id":"679dd25b-89f0-404c-95a8-146b970fda32","name":"Insert","language":"lua","code":"local nsQL = require(\"nsQL\")\n\n\t\t\t\t\tfunction main()\n   \t\t\t\t \tlocal query = [[ INSERT INTO nssim.sampledata (rowid,id,mapdata) VALUES ( 'cbb33c38-e51b-4846-bd7c-4d6ba0c7b68d','cbb33c38-e51b-4846-bd7c-4d6ba0c7b68d',{'blah':'0x0a09092020097b0a090920200909226e616d65223a2022627269616e732d6275636b6574222c0a090920200909226372656174696f6e44617465223a2022323031372d30352d33315432313a30373a34342e3131315a220a09092020097d'});]]\n       \t\t\t\t \tlocal source = {\n       \t\t\t\t \t    Protocol = \"cassandra\",\n        \t\t\t\t \t   Host = \"cassandra1-dev2-northstar.mon-marathon-service.mesos,cassandra2-dev2-northstar.mon-marathon-service.mesos,cassandra3-dev2-northstar.mon-marathon-service.mesos,cassandra4-dev2-northstar.mon-marathon-service.mesos,cassandra5-dev2-northstar.mon-marathon-service.mesos\",\n         \t\t\t\t \t  Port = \"31814\",\n          \t\t\t\t \t Backend = \"native\"\n      \t\t\t\t \t }\n      \t\t\t\t \t processQuery(query, source, {})\n   \t\t\t\t \tend\n\n   \t\t\t\t \tfunction processQuery(query, source, options)\n    \t\t\t\t \t   local resp, err = nsQL.query(query, source, options)\n     \t\t\t\t \t  if(err ~= nil) then\n      \t\t\t\t \t     error(err)\n      \t\t\t\t \t end\n      \t\t\t\t \t return resp\n   \t\t\t\t \tend","output":{"lastExecution":"0001-01-01T00:00:00Z","state":"Unknown","results":{"type":"","content":null}},"options":{"showCode":true,"showOutput":true,"timeout":180,"mainFunction":"main","visualization":{"parameters":null},"status":"","showConfiguration":true}},{"id":"a3d93bb3-39c4-40da-84d9-edf5de307e11","name":"Map_Blob_Json_Fetch","language":"lua","code":"local nsQL = require(\"nsQL\")\n\t\t\t\tlocal nsOutput = require(\"nsOutput\")\n\n\t\t\t\tfunction main()\n    \t\t\t\tlocal query = [[\n    \t\t\t\t    SELECT  MAP_BLOB_JSON_FETCH(mapdata, 'blah','name') as name\n    \t\t\t\t    FROM    nssim.sampledata\n    \t\t\t\t    WHERE   rowid = `cbb33c38-e51b-4846-bd7c-4d6ba0c7b68d`;\n    \t\t\t\t]]\n    \t\t\t\tlocal source = {\n    \t\t\t\t    Protocol = \"cassandra\",\n    \t\t\t\t    Host = \"cassandra1-dev2-northstar.mon-marathon-service.mesos,cassandra2-dev2-northstar.mon-marathon-service.mesos,cassandra3-dev2-northstar.mon-marathon-service.mesos,cassandra4-dev2-northstar.mon-marathon-service.mesos,cassandra5-dev2-northstar.mon-marathon-service.mesos\",\n  \t\t\t\t\t\tPort = \"31814\",\n     \t\t\t\t   Backend = \"spark\"\n    \t\t\t\t}\n    \t\t\t\tlocal result = processQuery(query, source, {})\n    \t\t\t\treturn generateTable(result)\n\t\t\t\tend\n\n\t\t\t\tfunction processQuery(query, source, options)\n   \t\t\t\t local resp, err = nsQL.query(query, source, options)\n   \t\t\t\t if(err ~= nil) then\n   \t\t\t\t     error(err)\n   \t\t\t\t end\n   \t\t\t\t return resp\n\t\t\t\tend\n\n\t\t\t\tfunction generateTable(table)\n \t\t\t\t   local out, err = nsOutput.table(table)\n \t\t\t\t   if(err ~= nil) then\n \t\t\t\t       error(err)\n \t\t\t\t   end\n  \t\t\t\t  return out\n\t\t\t\tend","output":{"lastExecution":"0001-01-01T00:00:00Z","state":"Unknown","results":{"type":"","content":null}},"options":{"showCode":true,"showOutput":true,"timeout":180,"mainFunction":"main","visualization":{"parameters":null},"status":"","showConfiguration":true}},{"id":"b79e14d0-218e-4b17-8f6d-a0a80f8930e1","name":"Delete Cell","language":"lua","code":"local nsQL = require(\"nsQL\")\n\n\t\t\t\tfunction main()\n    \t\t\t\tlocal query = [[\n \t\t\t\t       DELETE\n \t\t\t\t        FROM    nssim.sampledata\n \t\t\t\t       WHERE   rowid = `cbb33c38-e51b-4846-bd7c-4d6ba0c7b68d`;\n \t\t\t\t   ]]\n \t\t\t\t   local source = {\n \t\t\t\t      Protocol = \"cassandra\",\n        \t\t\t  Host = \"cassandra1-dev2-northstar.mon-marathon-service.mesos,cassandra2-dev2-northstar.mon-marathon-service.mesos,cassandra3-dev2-northstar.mon-marathon-service.mesos,cassandra4-dev2-northstar.mon-marathon-service.mesos,cassandra5-dev2-northstar.mon-marathon-service.mesos\",\n  \t\t\t\t      Port = \"31814\",\n  \t\t\t\t      Backend = \"native\"\n  \t\t\t\t  }\n  \t\t\t\t  processQuery(query, source, {})\n\t\t\t\tend\n\n\t\t\t\tfunction processQuery(query, source, options)\n \t\t\t\t   local resp, err = nsQL.query(query, source, options)\n \t\t\t\t   if(err ~= nil) then\n \t\t\t\t       error(err)\n \t\t\t\t   end\n \t\t\t\t   return resp\n\t\t\t\tend","output":{"lastExecution":"0001-01-01T00:00:00Z","state":"Unknown","results":{"type":"","content":null}},"options":{"showCode":true,"showOutput":true,"timeout":180,"mainFunction":"main","visualization":{"parameters":null},"status":"","showConfiguration":true}}]}